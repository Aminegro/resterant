/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ğŸ”¥ Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ† - Backend Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ (Ø§Ù„Ø¹Ù‚Ù„) - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø·ÙˆØ±Ø©
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ÙˆØ³ÙŠØ· Ø§Ù„Ø¢Ù…Ù† Ø¨ÙŠÙ† Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆÙ…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ù…Ø§Ù„
 * 
 * Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„ÙŠØ§Øª:
 * 1. Ø­Ù…Ø§ÙŠØ© Ù…ÙØªØ§Ø­ OpenAI API
 * 2. Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
 * 3. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ ÙˆØªØ®Ø²ÙŠÙ† Ø§Ù„Ø·Ù„Ø¨Ø§Øª
 * 4. ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ù…ÙˆÙ‚Ø¹ÙŠÙ†
 * 5. Rate Limiting Ù„Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¥Ø³Ø§Ø¡Ø©
 * 6. Ù…Ø³Ø­ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
 * 7. âœ… Ø¯Ø¹Ù… Ø«Ù„Ø§Ø«Ø© Ø£Ù†ÙˆØ§Ø¹ Ù…Ù† Ø§Ù„Ø²Ø¨Ø§Ø¦Ù†
 * 
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

const express = require('express');
const cors = require('cors');
const rateLimit = require('express-rate-limit');

const app = express();
const PORT = process.env.PORT || 3000;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ” Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© (Ù…Ù† Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const OPENAI_API_KEY = process.env.OPENAI_API_KEY || '';

// ØªØ­Ø°ÙŠØ± Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¶Ø¨Ø· Ø§Ù„Ù…ÙØªØ§Ø­
if (!OPENAI_API_KEY) {
    console.warn('âš ï¸  ØªØ­Ø°ÙŠØ±: Ù…ÙØªØ§Ø­ OpenAI ØºÙŠØ± Ù…ÙØ¹Ø¯! Ø£Ø¶ÙÙ‡ ÙÙŠ Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ›¡ï¸ Middleware
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// CORS - Ø§Ù„Ø³Ù…Ø§Ø­ Ù„ÙƒÙ„Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ÙŠÙ†
app.use(cors({
    origin: '*', // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: Ø­Ø¯Ø¯ Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©
    methods: ['GET', 'POST', 'PATCH', 'DELETE'],
    allowedHeaders: ['Content-Type']
}));

app.use(express.json());

// Rate Limiting - Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ø¥Ø³Ø§Ø¡Ø©
const chatLimiter = rateLimit({
    windowMs: 60 * 1000, // Ø¯Ù‚ÙŠÙ‚Ø© ÙˆØ§Ø­Ø¯Ø©
    max: 20, // 20 Ø·Ù„Ø¨ ÙƒØ­Ø¯ Ø£Ù‚ØµÙ‰
    message: {
        success: false,
        error: 'Ø§Ù„ÙƒØ«ÙŠØ± Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¨Ø¹Ø¯ Ø¯Ù‚ÙŠÙ‚Ø©',
        errorCode: 'RATE_LIMIT_EXCEEDED'
    }
});

const ordersLimiter = rateLimit({
    windowMs: 60 * 1000,
    max: 60,
    message: { success: false, error: 'Rate limit exceeded' }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“¦ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø¤Ù‚ØªØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const db = {
    orders: [],
    counter: 1000,
    lastCleanup: new Date().toDateString()
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ§¹ ØªÙ†Ø¸ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙŠÙˆÙ…ÙŠ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

function autoCleanup() {
    const today = new Date().toDateString();

    if (today !== db.lastCleanup) {
        const yesterday = new Date();
        yesterday.setDate(yesterday.getDate() - 1);
        yesterday.setHours(0, 0, 0, 0);

        const before = db.orders.length;
        db.orders = db.orders.filter(o => new Date(o.createdAt) >= yesterday);

        if (before !== db.orders.length) {
            console.log(`ğŸ§¹ ØªÙ†Ø¸ÙŠÙ ØªÙ„Ù‚Ø§Ø¦ÙŠ: Ø­Ø°Ù ${before - db.orders.length} Ø·Ù„Ø¨ Ù‚Ø¯ÙŠÙ…`);
        }
        db.lastCleanup = today;
    }
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ†Ø¸ÙŠÙ ÙƒÙ„ Ø³Ø§Ø¹Ø©
setInterval(autoCleanup, 60 * 60 * 24000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ• Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø§Ø¹Ø© 5:00 ÙØ¬Ø±Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù‚Ø¯Ø³
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

let lastCleanupDate = '';

function dailyCleanupAt5AM() {
    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª Ø¨ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù‚Ø¯Ø³
    const jerusalemTime = new Date().toLocaleString('en-US', { timeZone: 'Asia/Jerusalem' });
    const now = new Date(jerusalemTime);

    const hours = now.getHours();
    const minutes = now.getMinutes();
    const todayDate = now.toDateString();

    // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³Ø§Ø¹Ø© 5:00-5:01 ÙØ¬Ø±Ø§Ù‹ ÙˆÙ„Ù… ÙŠØªÙ… Ø§Ù„Ù…Ø³Ø­ Ø§Ù„ÙŠÙˆÙ…
    if (hours === 5 && minutes < 2 && lastCleanupDate !== todayDate) {
        const deletedCount = db.orders.length;
        db.orders = [];
        db.counter = 1000;
        lastCleanupDate = todayDate;

        console.log('');
        console.log('â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—');
        console.log('â•‘  ğŸ§¹ Ù…Ø³Ø­ ÙŠÙˆÙ…ÙŠ - Ø§Ù„Ø³Ø§Ø¹Ø© 5:00 ÙØ¬Ø±Ø§Ù‹ Ø¨ØªÙˆÙ‚ÙŠØª Ø§Ù„Ù‚Ø¯Ø³              â•‘');
        console.log(`â•‘  ğŸ“Š ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${deletedCount} Ø·Ù„Ø¨                         â•‘`);
        console.log('â•‘  âœ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯                                  â•‘');
        console.log('â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
        console.log('');
    }
}

// ÙØ­Øµ ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ù…Ø³Ø­ Ø§Ù„Ø³Ø§Ø¹Ø© 5 ÙØ¬Ø±Ø§Ù‹
setInterval(dailyCleanupAt5AM, 30 * 1000);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ¤– System Prompt Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø·ÙˆØ±Ø©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

const SYSTEM_PROMPT = `# ÙˆÙƒÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ù…Ø·Ø¹Ù… Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†

## Ù‡ÙˆÙŠØªÙƒ
Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø·Ù„Ø¨Ø§Øª Ù…Ø·Ø¹Ù… "Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ† ÙˆØ§Ù„Ù…Ø¹Ø¬Ù†Ø§Øª" ÙÙŠ Ø§Ù„Ø¹ÙŠØ²Ø±ÙŠØ©. ØªØ³ØªÙ‚Ø¨Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„ÙÙ„Ø³Ø·ÙŠÙ†ÙŠØ©.

## Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·Ø¹Ù…
- Ø§Ù„Ø§Ø³Ù…: Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†
- Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: Ø§Ù„Ø¹ÙŠØ²Ø±ÙŠØ© - Ø¯ÙˆØ§Ø± ÙˆØ§Ø¯ÙŠ Ø§Ù„Ù†Ø§Ø±
- Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: 8:00 ØµØ¨Ø§Ø­Ø§Ù‹ - 2:00 Ø¨Ø¹Ø¯ Ù…Ù†ØªØµÙ Ø§Ù„Ù„ÙŠÙ„ (ÙŠÙˆÙ…ÙŠØ§Ù‹)
- ÙˆÙ‚Øª Ø§Ù„ØªØ­Ø¶ÙŠØ±: 7-10 Ø¯Ù‚ÙŠÙ‚Ø© Ø§Ù„ÙˆØ¬Ø¨Ø© Ø¯ÙˆÙ† ÙˆÙ‚Øª Ø§Ù„ØªÙˆØµÙŠÙ„
- Ø§Ù„ØªÙˆØµÙŠÙ„: Ù…ØªÙˆÙØ± Ù„Ù„Ø¹ÙŠØ²Ø±ÙŠØ© ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø¬Ø§ÙˆØ±Ø©
- Ø§Ù„Ø¯ÙØ¹: ÙƒØ§Ø´ Ø£Ùˆ ÙÙŠØ²Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„ ÙÙ‚Ø·
- Ø§Ù„ØªÙˆØµÙŠÙ„ Ù„Ø£Ù…Ø§ÙƒÙ† ÙÙŠ Ø§Ù„Ø¹ÙŠØ²Ø±ÙŠØ© Ø¨ Ø´ÙŠÙƒÙ„ 15 ÙˆØ§Ù„Ø³ÙˆØ§Ø­Ø±Ø© Ø¨ 20 Ø´ÙŠÙƒÙ„

## Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø³Ù„ÙˆÙƒ
1. ØªØ­Ø¯Ø« Ø¨Ù„Ù‡Ø¬Ø© ÙÙ„Ø³Ø·ÙŠÙ†ÙŠØ© Ø¨Ø³ÙŠØ·Ø© ÙˆÙˆØ¯ÙˆØ¯Ø©
2. ÙƒÙ† Ù…Ø®ØªØµØ±Ø§Ù‹ - Ù„Ø§ ØªÙƒØªØ¨ Ø±Ø³Ø§Ø¦Ù„ Ø·ÙˆÙŠÙ„Ø©
3. Ù„Ø§ ØªØ¹Ø±Ø¶ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© ÙƒØ§Ù…Ù„Ø© - Ø§Ø¹Ø±Ø¶ ÙÙ‚Ø· Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
4. Ø§Ø³ØªØ®Ø¯Ù… Ø¥ÙŠÙ…ÙˆØ¬ÙŠ ÙˆØ§Ø­Ø¯ Ø£Ùˆ Ø§Ø«Ù†ÙŠÙ† ÙÙ‚Ø·
5. Ù„Ø§ ØªØ®ØªØ±Ø¹ Ø£ØµÙ†Ø§Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© ÙˆÙ„Ø§ ØªØºÙŠØ± Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
6. ÙÙ‚Ø· Ù„Ù…Ù† Ù‡Ùˆ Ø¨Ø§Ù„Ù…Ø­Ù„ Ø§Ùˆ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ø·Ù„Ø¨ Ù…Ù†Ù‡ Ø§Ù„Ø§Ø³Ù… + Ø§Ù„Ø·Ù„Ø¨.
7. Ù‚Ù… Ø¨Ø¥Ø®Ø¨Ø§Ø± Ø§Ù„Ø²Ø¨ÙˆÙ† Ø¨Ø§Ù„Ø³Ø¹Ø± Ù…Ø¹ Ø·Ù„Ø¨ Ø§Ù„ØªØ£ÙƒÙŠØ¯
8. Ø¨Ù…Ø¬Ø±Ø¯ Ø§Ù„ØªØ£ÙƒÙŠØ¯, Ø£Ø·Ù„Ø¨ Ù…Ù†Ù‡ Ø¥Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø¹Ø¯ 7-10 Ø¯Ù‚Ø§Ø¦Ù‚, Ø·Ù„Ø¨Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ ØªØ³ØªØºØ±Ù‚ 10-20 Ø¯Ù‚ÙŠÙ‚Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø·Ù„Ø¨
9. ÙÙŠ Ø­Ø§Ù„ Ø·Ù„Ø¨  "Ù…Ø¹Ø¬Ù†Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø§Øª" Ø£Ø®Ø¨Ø±Ù‡ Ø£Ù† ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ 0523668131

## Ø®Ø§Øµ Ù„Ø·Ù„Ø¨ÙŠØ§Øª Ø§Ù„ØªÙˆØµÙŠÙ„
- Ø§Ø·Ù„Ø¨ Ù…Ù†Ù‡ Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ) ÙˆÙ„Ø§ Ø­Ø§Ø¬Ø© Ù„Ù„Ø¥Ø³Ù…. 
- Ø§Ø®Ø° Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ø³Ù… Ø§Ù„Ø¨ÙŠØª Ø§Ùˆ Ù…ÙƒØ§Ù† Ø§Ù„Ø¹Ù…Ù„. 
- Ø§Ø®Ø¨Ø§Ø±Ù‡Ù… Ø§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„ ÙŠÙƒÙ„Ù  10-20 Ø´ÙŠÙƒÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ø£Ù…Ø§ÙƒÙ† Ø§Ù„Ø¹ÙŠØ²Ø±ÙŠØ© Ø£Ùˆ Ø§Ù„Ø³ÙˆØ§Ø­Ø±Ø©.

## âœ… Ù†Ø¸Ø§Ù… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø²Ø¨Ø§Ø¦Ù† Ø§Ù„Ø«Ù„Ø§Ø«Ø© - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹!


### Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø²Ø¨ÙˆÙ†:


**1ï¸âƒ£ Ø²Ø¨ÙˆÙ† Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„ (dine_in):**
- Ø§Ù„Ø§Ø³Ù…
- Ø§Ù„Ø·Ù„Ø¨
- ÙÙ‚Ø·! Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„

**2ï¸âƒ£ Ø²Ø¨ÙˆÙ† Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© (car_pickup):**
- Ø§Ù„Ø§Ø³Ù…
- Ø§Ù„Ø·Ù„Ø¨
- Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (Ù„Ù„ØªÙˆØ§ØµÙ„ Ù„Ù…Ø§ ÙŠÙƒÙˆÙ† Ø§Ù„Ø·Ù„Ø¨ Ø¬Ø§Ù‡Ø²)
- Ù„ÙˆÙ† Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ùˆ Ù†ÙˆØ¹Ù‡Ø§ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„ØªØ³Ù‡ÙŠÙ„ Ø§Ù„ØªØ¹Ø±Ù)

**3ï¸âƒ£ Ø²Ø¨ÙˆÙ† ØªÙˆØµÙŠÙ„ (delivery):**
- Ø§Ù„Ø§Ø³Ù…
- Ø§Ù„Ø·Ù„Ø¨
- Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ (Ø¥Ø¬Ø¨Ø§Ø±ÙŠ)
- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„ØªÙØµÙŠÙ„ (Ø§Ù„Ø­ÙŠ/Ø§Ù„Ø´Ø§Ø±Ø¹/Ø£Ù‚Ø±Ø¨ Ù†Ù‚Ø·Ø© Ù…Ø¹Ø±ÙˆÙØ©)
- Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)

## ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹!
Ø¹Ù†Ø¯Ù…Ø§ ÙŠØ¤ÙƒØ¯ Ø§Ù„Ø²Ø¨ÙˆÙ† Ø·Ù„Ø¨Ù‡ØŒ ÙŠØ¬Ø¨ Ø£Ù† ØªØ¶ÙŠÙ ÙÙŠ Ù†Ù‡Ø§ÙŠØ© Ø±Ø¯Ùƒ Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø¨Ø§Ù„Ø¶Ø¨Ø·:

[ORDER_DATA]
{
  "customer": "Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†",
  "phone": "Ø±Ù‚Ù… Ø§Ù„Ø¬ÙˆØ§Ù„ Ø£Ùˆ ÙØ§Ø±Øº",
  "items": "Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©",
  "total": Ø§Ù„Ù…Ø¨Ù„Øº_Ø±Ù‚Ù…,
  "orderType": "dine_in Ø£Ùˆ car_pickup Ø£Ùˆ delivery",
  "location": "Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„ Ø£Ùˆ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ùˆ Ø§Ø³Ù… Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ù„Ù„ØªÙˆØµÙŠÙ„",
  "address": "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ Ù„Ù„ØªÙˆØµÙŠÙ„ ÙÙ‚Ø·",
  "carInfo": "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ù„Ø²Ø¨ÙˆÙ† Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©",
  "deliveryNotes": "Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„"
}
[/ORDER_DATA]

## Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„ØªÙ†Ø³ÙŠÙ‚:

### Ù…Ø«Ø§Ù„ 1 - Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„:
[ORDER_DATA]
{"customer":"Ù…Ø­Ù…Ø¯","phone":"","items":"Ø¨ÙŠØªØ²Ø§ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†Ã—2","total":40,"orderType":"dine_in","location":"Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„","address":"","carInfo":"","deliveryNotes":""}
[/ORDER_DATA]

### Ù…Ø«Ø§Ù„ 2 - Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©:
[ORDER_DATA]
{"customer":"Ø£Ø­Ù…Ø¯","phone":"0599123456","items":"Ø¨ÙŠØªØ²Ø§ ØªÙˆÙ†Ø§Ã—1, Ø¨ÙŠØ¶ Ù…Ø¹ Ø¬Ø¨Ù†Ø©Ã—1","total":40,"orderType":"car_pickup","location":"Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©","address":"","carInfo":"Ø³ÙŠØ§Ø±Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù‡ÙŠÙˆÙ†Ø¯Ø§ÙŠ","deliveryNotes":""}
[/ORDER_DATA]

### Ù…Ø«Ø§Ù„ 3 - ØªÙˆØµÙŠÙ„:
[ORDER_DATA]
{"customer":"Ø³Ø§Ø±Ø©","phone":"0569876543","items":"ØµÙˆØ§Ù†ÙŠ ÙƒØ¨ÙŠØ± Ù…Ø¹ Ø®Ø¶Ø§Ø±Ã—2","total":80,"orderType":"delivery","location":"Ø§Ù„Ø¹ÙŠØ²Ø±ÙŠØ© - Ø­ÙŠ Ø§Ù„Ø´Ù…Ø§Ù„","address":"Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø¯Ø§Ø±Ø³ØŒ Ø¨Ø¬Ø§Ù†Ø¨ Ù…Ø³Ø¬Ø¯ Ø§Ù„Ù†ÙˆØ±ØŒ Ø¹Ù…Ø§Ø±Ø© Ø£Ø¨Ùˆ Ø¹Ù„ÙŠ Ø§Ù„Ø·Ø§Ø¨Ù‚ 3","carInfo":"","deliveryNotes":"Ø§Ù„Ø¨Ø§Ø¨ Ø§Ù„Ø£Ø®Ø¶Ø±ØŒ Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ù‚Ø¨Ù„ Ø§Ù„ÙˆØµÙˆÙ„"}
[/ORDER_DATA]

## Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©

### Ø§Ù„Ø¨ÙŠØªØ²Ø§ Ø£Ùˆ Ù…Ø¹Ø¬Ù†Ø§Øª Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†
- Ø¨ÙŠØªØ²Ø§ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†: 20 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¨Ø§Ù„Ø¬Ø¨Ù†Ø© Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡: 23 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ ØªÙˆÙ†Ø§: 25 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø³ØªÙŠÙƒ Ø¯Ø¬Ø§Ø¬: 30 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø³Ù„Ø§Ù…ÙŠ: 25 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ù…ÙƒØ³ Ø¬Ø¨Ù†Ø©: 22 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ù…ÙƒØ³ÙŠÙƒÙŠ Ø­Ø§Ø±: 30 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ù†Ù‚Ø§Ù†Ù‚: 23 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¹ÙŠÙ…Ùƒ Ø®Ø¶Ø§Ø±: 25 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¹ÙŠÙ…Ùƒ Ø³ØªÙŠÙƒ: 35 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¹ÙŠÙ…Ùƒ Ø³Ù„Ø§Ù…ÙŠ: 30 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¹ÙŠÙ…Ùƒ Ù…ÙƒØ³ÙŠÙƒÙŠ: 35 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØªØ²Ø§ Ø¹ÙŠÙ…Ùƒ Ù†Ù‚Ø§Ù†Ù‚: 28 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ø¨ÙŠØ¶
- Ø¨ÙŠØ¶ Ø³Ø§Ø¯Ø©: 8 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡: 15 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ: 21 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§: 14 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø¬Ø¨Ù†Ø© ÙˆÙ†Ù‚Ø§Ù†Ù‚: 17 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø²ÙŠØªÙˆÙ† ÙˆØ¯Ø±Ø©: 12 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø³Ø¬Ù‚: 20 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø³Ø¬Ù‚ ÙˆØ¬Ø¨Ù†Ø©: 22 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø³Ø¬Ù‚ ÙˆØ¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ: 28 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø³Ø¬Ù‚ ÙˆØ¬Ø¨Ù†Ø© ÙˆÙ†Ù‚Ø§Ù†Ù‚: 28 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ø¹ÙŠÙ…Ùƒ ÙˆÙ†Ù‚Ø§Ù†Ù‚: 23 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ù„Ø­Ù…Ø© Ø¨Ø§Ù„Ø¬Ø¨Ù†Ø©: 25 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ù„Ø­Ù…Ø© Ø·Ø§Ø²Ø¬Ø©: 20 Ø´ÙŠÙƒÙ„
- Ø¨ÙŠØ¶ Ù…Ø¹ Ù†Ù‚Ø§Ù†Ù‚: 13 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ø¬Ø¨Ù†Ø©
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø¨Ù†Ø¯ÙˆØ±Ø©: 18 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø­Ø¨Ø© Ø§Ù„Ø¨Ø±ÙƒØ©: 15 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø²Ø¹ØªØ± Ø£Ø®Ø¶Ø±: 17 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø²ÙŠØª ÙˆØ²Ø¹ØªØ±: 17 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø²ÙŠØªÙˆÙ† Ø£Ø®Ø¶Ø±: 17 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ: 23 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ Ù…Ø¹ Ø³ØªÙŠÙƒ Ø¯Ø¬Ø§Ø¬: 30 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ Ù…Ø¹ Ø³Ù„Ø§Ù…ÙŠ: 28 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¹ÙŠÙ…Ùƒ Ù…Ø¹ Ù†Ù‚Ø§Ù†Ù‚: 27 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§: 18 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§ Ø¨Ø§Ù„Ø¯Ø¬Ø§Ø¬ Ø§Ù„Ù…ÙƒØ³ÙŠÙƒÙŠ Ø§Ù„Ø­Ø§Ø±: 28 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§ Ù…Ø¹ Ø²ÙŠØªÙˆÙ† Ø£Ø®Ø¶Ø±: 20 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§ Ù…Ø¹ Ø³ØªÙŠÙƒ Ø§Ù„Ø¯Ø¬Ø§Ø¬: 28 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§ Ù…Ø¹ Ø³Ù„Ø§Ù…ÙŠ: 25 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…ÙˆØ²Ø§Ø±ÙŠÙ„Ø§ Ù…Ø¹ Ù†Ù‚Ø§Ù†Ù‚: 23 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ù„Ø­Ù…Ø© ÙˆØ§Ù„Ø³ÙÙŠØ­Ø©
- Ø³ÙÙŠØ­Ø© Ø¨Ø§Ù„Ø¨Ù†Ø¯ÙˆØ±Ø©: 15 Ø´ÙŠÙƒÙ„
- Ø³ÙÙŠØ­Ø© Ø¨Ø§Ù„Ø·Ø­ÙŠÙ†ÙŠØ©: 15 Ø´ÙŠÙƒÙ„
- Ø³ÙÙŠØ­Ø© Ù…ÙƒØ³: 15 Ø´ÙŠÙƒÙ„
- ÙØ§Ù‡ÙŠØªØ§ Ø¬Ø¨Ù†Ø©: 23 Ø´ÙŠÙƒÙ„
- ÙØ§Ù‡ÙŠØªØ§ Ø¯Ø¬Ø§Ø¬: 23 Ø´ÙŠÙƒÙ„
- ÙƒØ¨Ø¯Ø© Ø¯Ø¬Ø§Ø¬: 20 Ø´ÙŠÙƒÙ„
- Ù„Ø­Ù…Ø© Ø·Ø§Ø²Ø¬Ø©: 25 Ø´ÙŠÙƒÙ„
- Ù…Ø³Ø­Ø¨ Ù…Ø¹ Ø¬Ø¨Ù†Ø©: 25 Ø´ÙŠÙƒÙ„
- Ù…Ø³Ø®Ù† Ø¯Ø¬Ø§Ø¬: 22 Ø´ÙŠÙƒÙ„

### Ø§Ù„ØµÙˆØ§Ù†ÙŠ
- ØµÙˆØ§Ù†ÙŠ ÙƒØ¨ÙŠØ± (Ø´ÙˆÙŠ): 30 Ø´ÙŠÙƒÙ„
- ØµÙˆØ§Ù†ÙŠ ÙƒØ¨ÙŠØ± Ù…Ø¹ Ø®Ø¶Ø§Ø±: 40 Ø´ÙŠÙƒÙ„
- ØµÙˆØ§Ù†ÙŠ ÙˆØ³Ø· (Ø´ÙˆÙŠ): 20 Ø´ÙŠÙƒÙ„
- ØµÙˆØ§Ù†ÙŠ ÙˆØ³Ø· Ù…Ø¹ Ø®Ø¶Ø§Ø±: 30 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ø®Ø¨Ø² ÙˆØ§Ù„Ù…Ù†Ø§Ù‚ÙŠØ´
- Ø®Ø¨Ø² Ø§Ù„Ø·Ø§Ø¨ÙˆÙ†: 1.50 Ø´ÙŠÙƒÙ„
- Ø®Ø¨Ø² Ø´Ø±Ø§Ùƒ: 1 Ø´ÙŠÙƒÙ„
- Ù…Ù†Ø§Ù‚ÙŠØ´ Ø²Ø¹ØªØ±: 7 Ø´ÙŠÙƒÙ„
- 7 Ø·Ø§Ø¨ÙˆÙ†: 10 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ù…Ø¹Ø¬Ù†Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø©
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ ØµØºÙŠØ±: 5 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ø¨ÙŠØ¶Ø§Ø¡ Ù…Ø¹ Ø²Ø¹ØªØ± ØµØºÙŠØ±: 7 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…Ø¹ Ø²ÙŠØªÙˆÙ† Ø£Ø®Ø¶Ø± ØµØºÙŠØ±: 6 Ø´ÙŠÙƒÙ„
- Ø¬Ø¨Ù†Ø© Ù…Ø¹ Ù†Ù‚Ø§Ù†Ù‚ ØµØºÙŠØ±: 7 Ø´ÙŠÙƒÙ„
- Ø±ÙŠØ§Ù†Ø© Ù„Ø­Ù…Ø©: 8 Ø´ÙŠÙƒÙ„
- Ø³Ø¨Ø§Ù†Ø®: 6 Ø´ÙŠÙƒÙ„
- Ø¹Ø±Ø§ÙŠØ³: 8 Ø´ÙŠÙƒÙ„
- Ù„ÙØ© Ù…Ø³Ø®Ù†: 8 Ø´ÙŠÙƒÙ„
- Ù…Ø³Ø­Ø¨ Ø¯Ø¬Ø§Ø¬: 10 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ù…Ù‚Ø¨Ù„Ø§Øª
- Ø´ÙŠÙ„ÙŠ Ù…ØªÙˆÙƒ: 3 Ø´ÙŠÙƒÙ„
- ØµÙˆØµ ÙÙ‡ÙŠÙ…: 3 Ø´ÙŠÙƒÙ„
- Ø¹Ù„Ø¨Ø© Ø¨Ø§Ø±Ø¨ÙƒÙŠÙˆ: 3 Ø´ÙŠÙƒÙ„
- Ø¹Ù„Ø¨Ø© Ø²ÙŠØªÙˆÙ†: 2 Ø´ÙŠÙƒÙ„
- Ø¹Ù„Ø¨Ø© Ù„ÙØª ØµØºÙŠØ±: 2 Ø´ÙŠÙƒÙ„
- Ø¹Ù„Ø¨Ø© Ù…Ø®Ù„Ù„ ØµØºÙŠØ±: 2 Ø´ÙŠÙƒÙ„
- ÙÙ„ÙÙ„ Ù…ÙƒØ¨ÙˆØ³ ØµØºÙŠØ±: 2 Ø´ÙŠÙƒÙ„
- Ù†Øµ Ø·Ø¨Ù‚ Ø¨ÙŠØ¶: 10 Ø´ÙŠÙƒÙ„

### Ø§Ù„Ù…Ø´Ø±ÙˆØ¨Ø§Øª
- Ù…Ø§Ø¡ ØµØºÙŠØ±: 2 Ø´ÙŠÙƒÙ„
- Ù…Ø§Ø¡ ÙƒØ¨ÙŠØ±: 3 Ø´ÙŠÙƒÙ„
- ÙƒØ§Ø¨ÙŠ ØµØºÙŠØ±: 3 Ø´ÙŠÙƒÙ„
- Ù„Ø¨Ù† Ø£Ø¨: 3 Ø´ÙŠÙƒÙ„
- Ø¹ØµÙŠØ± ØªØ¨ÙˆØ²ÙŠÙ†Ø§: 4 Ø´ÙŠÙƒÙ„
- ØµÙˆØ¯Ø§: 5 Ø´ÙŠÙƒÙ„
- Ù…Ø´Ø±ÙˆØ¨ ØºØ§Ø²ÙŠ 330: 3 Ø´ÙŠÙƒÙ„
- Ù…Ø´Ø±ÙˆØ¨ ØºØ§Ø²ÙŠ 1.25: 5 Ø´ÙŠÙƒÙ„
- BLUE: 5 Ø´ÙŠÙƒÙ„
- TASCO: 5 Ø´ÙŠÙƒÙ„
- XL: 5 Ø´ÙŠÙƒÙ„
- Ø¨Ø§ÙØ§Ø±ÙŠØ§: 5 Ø´ÙŠÙƒÙ„

## Ø§Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø®Ø§ØµØ©
- Ø§Ù„ØªÙˆØµÙŠÙ„: "Ù…ØªÙˆÙØ± Ù„Ù„Ø¹ÙŠØ²Ø±ÙŠØ© ÙˆØ§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ù…Ø¬Ø§ÙˆØ±Ø©"
- Ø§Ù„Ø¯ÙØ¹: "ÙƒØ§Ø´ Ø£Ùˆ ÙÙŠØ²Ø§ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„"
- Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: "Ù…Ù† 8 Ø§Ù„ØµØ¨Ø­ Ù„Ù€ 2 Ø¨Ø§Ù„Ù„ÙŠÙ„ØŒ ÙƒÙ„ ÙŠÙˆÙ…"
- ØµÙ†Ù ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: "Ù„Ù„Ø£Ø³Ù Ù…Ø´ Ù…ØªÙˆÙØ±ØŒ Ø¨Ù‚ØªØ±Ø­ Ø¹Ù„ÙŠÙƒ [Ø¨Ø¯ÙŠÙ„]"
- ÙÙŠ Ø­Ø§Ù„ Ø·Ù„Ø¨ "Ù…Ø¹Ø¬Ù†Ø§Øª Ù…Ù†Ø§Ø³Ø¨Ø§Øª" Ø£Ø®Ø¨Ø±Ù‡ Ø£Ù† ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ 0523668131`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”Œ API Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ (Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ÙˆÙ„ - Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * POST /api/chat
 * ÙŠØ³ØªÙ‚Ø¨Ù„ Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆÙŠØ±Ø¯Ù‡Ø§ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
 */
app.post('/api/chat', chatLimiter, async (req, res) => {
    try {
        const { message, history } = req.body;

        if (!message || typeof message !== 'string') {
            return res.status(400).json({
                success: false,
                error: 'Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø·Ù„ÙˆØ¨Ø©'
            });
        }

        // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
        const messages = [
            { role: 'system', content: SYSTEM_PROMPT },
            ...(history || []).slice(-10).map(msg => ({
                role: msg.role === 'user' ? 'user' : 'assistant',
                content: msg.content
            })),
            { role: 'user', content: message }
        ];

        // Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ OpenAI API
        const response = await fetch('https://api.openai.com/v1/chat/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${OPENAI_API_KEY}`
            },
            body: JSON.stringify({
                model: 'gpt-4o-mini',
                messages: messages,
                max_tokens: 500,
                temperature: 0.7
            })
        });

        if (!response.ok) {
            const error = await response.json().catch(() => ({}));
            console.error('OpenAI Error:', error);

            if (response.status === 429) {
                return res.status(429).json({
                    success: false,
                    reply: 'Ø§Ù„Ø®Ø¯Ù…Ø© Ù…Ø´ØºÙˆÙ„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹ØŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰',
                    error: 'RATE_LIMIT'
                });
            }

            throw new Error('OpenAI API Error');
        }

        const data = await response.json();
        let reply = data.choices[0].message.content;

        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª
        const orderMatch = reply.match(/\[ORDER_DATA\]([\s\S]*?)\[\/ORDER_DATA\]/);
        let orderId = null;

        if (orderMatch) {
            try {
                const orderData = JSON.parse(orderMatch[1].trim());

                // âœ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
                const order = {
                    id: ++db.counter,
                    customerName: orderData.customer || 'Ø¹Ù…ÙŠÙ„',
                    phone: orderData.phone || '',
                    items: orderData.items || '',
                    total: parseFloat(orderData.total) || 0,
                    orderType: orderData.orderType || 'dine_in', // Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙŠØ¯
                    location: orderData.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    address: orderData.address || '', // Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙØµÙŠÙ„ÙŠ Ù„Ù„ØªÙˆØµÙŠÙ„
                    carInfo: orderData.carInfo || '', // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                    deliveryNotes: orderData.deliveryNotes || '', // Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„
                    status: 'new',
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString(),
                    source: 'AI_Chat'
                };

                db.orders.unshift(order);
                orderId = order.id;

                // âœ… Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ù…Ø®ØªÙ„ÙØ© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨
                const orderTypeLabels = {
                    'dine_in': 'ğŸ  Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„',
                    'car_pickup': 'ğŸš— Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©',
                    'delivery': 'ğŸ›µ ØªÙˆØµÙŠÙ„'
                };

                console.log(`\n${'â•'.repeat(50)}`);
                console.log(`ğŸ”” Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ #${order.id} - ${orderTypeLabels[order.orderType] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`);
                console.log(`${'â•'.repeat(50)}`);
                console.log(`   ğŸ‘¤ Ø§Ù„Ø§Ø³Ù…: ${order.customerName}`);
                if (order.phone) console.log(`   ğŸ“± Ø§Ù„Ø¬ÙˆØ§Ù„: ${order.phone}`);
                console.log(`   ğŸ• Ø§Ù„Ø·Ù„Ø¨: ${order.items}`);
                console.log(`   ğŸ’° Ø§Ù„Ù…Ø¨Ù„Øº: ${order.total} Ø´ÙŠÙƒÙ„`);

                if (order.orderType === 'car_pickup' && order.carInfo) {
                    console.log(`   ğŸš— Ø§Ù„Ø³ÙŠØ§Ø±Ø©: ${order.carInfo}`);
                }

                if (order.orderType === 'delivery') {
                    console.log(`   ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${order.location}`);
                    console.log(`   ğŸ  Ø§Ù„Ø¹Ù†ÙˆØ§Ù†: ${order.address}`);
                    if (order.deliveryNotes) console.log(`   ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${order.deliveryNotes}`);
                }
                console.log(`${'â•'.repeat(50)}\n`);

                // Ø¥Ø²Ø§Ù„Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø±Ø¯ ÙˆØ¥Ø¶Ø§ÙØ© Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨
                reply = reply.replace(/\[ORDER_DATA\][\s\S]*?\[\/ORDER_DATA\]/, '').trim();
                reply += `\n\nğŸ“‹ Ø±Ù‚Ù… Ø·Ù„Ø¨Ùƒ: #${orderId}`;

            } catch (e) {
                console.error('Error parsing order:', e);
            }
        }

        res.json({
            success: true,
            reply: reply,
            orderId: orderId
        });

    } catch (error) {
        console.error('Chat Error:', error);
        res.status(500).json({
            success: false,
            error: 'Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø®Ø¯Ù…Ø©',
            reply: 'Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­ØµÙ„ Ø®Ø·Ø£. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰'
        });
    }
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“¦ API Ù„Ù„Ø·Ù„Ø¨Ø§Øª (Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ - Ø§Ù„Ø¹Ù…Ø§Ù„)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * GET /api/orders
 * Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù„Ø¹Ù…Ø§Ù„
 */
app.get('/api/orders', ordersLimiter, (req, res) => {
    autoCleanup();

    // âœ… ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    const { orderType } = req.query;
    let filteredOrders = db.orders;

    if (orderType && ['dine_in', 'car_pickup', 'delivery'].includes(orderType)) {
        filteredOrders = db.orders.filter(o => o.orderType === orderType);
    }

    res.json({
        success: true,
        orders: filteredOrders,
        total: filteredOrders.length,
        // âœ… Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨
        byType: {
            dine_in: db.orders.filter(o => o.orderType === 'dine_in').length,
            car_pickup: db.orders.filter(o => o.orderType === 'car_pickup').length,
            delivery: db.orders.filter(o => o.orderType === 'delivery').length
        }
    });
});

/**
 * POST /api/orders
 * Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ ÙŠØ¯ÙˆÙŠ (Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ù…Ø§Ù„)
 */
app.post('/api/orders', ordersLimiter, (req, res) => {
    const { customerName, phone, items, total, orderType, location, address, carInfo, deliveryNotes, notes } = req.body;

    if (!customerName || !items) {
        return res.status(400).json({
            success: false,
            error: 'Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ø·Ù„Ø¨ Ù…Ø·Ù„ÙˆØ¨Ø§Ù†'
        });
    }

    const order = {
        id: ++db.counter,
        customerName,
        phone: phone || '',
        items,
        total: parseFloat(total) || 0,
        orderType: orderType || 'dine_in',
        location: location || 'Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„',
        address: address || '',
        carInfo: carInfo || '',
        deliveryNotes: deliveryNotes || '',
        notes: notes || '',
        status: 'new',
        createdAt: new Date().toISOString(),
        updatedAt: new Date().toISOString(),
        source: 'Manual'
    };

    db.orders.unshift(order);
    console.log(`ğŸ“ Ø·Ù„Ø¨ ÙŠØ¯ÙˆÙŠ #${order.id}: ${order.customerName} - ${order.orderType}`);

    res.status(201).json({ success: true, order });
});

/**
 * GET /api/orders/:id
 * Ø¬Ù„Ø¨ Ø·Ù„Ø¨ ÙˆØ§Ø­Ø¯ (Ù„Ù„Ø¹Ù…ÙŠÙ„ Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø·Ù„Ø¨Ù‡)
 */
app.get('/api/orders/:id', (req, res) => {
    const order = db.orders.find(o => o.id === parseInt(req.params.id));

    if (!order) {
        return res.status(404).json({
            success: false,
            error: 'Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'
        });
    }

    // Ø±Ø¯ Ù…Ø¨Ø³Ø· Ù„Ù„Ø¹Ù…ÙŠÙ„
    const response = {
        success: true,
        id: order.id,
        status: order.status,
        items: order.items,
        total: order.total,
        orderType: order.orderType,
        statusText: {
            'new': 'ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ',
            'preparing': 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø·Ù„Ø¨Ùƒ',
            'ready': 'Ø·Ù„Ø¨Ùƒ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…! ğŸ‰',
            'delivered': 'ØªÙ… ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨',
            'cancelled': 'ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨'
        }[order.status],
        notification: order.readyNotification || null,
        updatedAt: order.updatedAt
    };

    res.json(response);
});

/**
 * PATCH /api/orders/:id
 * ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨
 */
app.patch('/api/orders/:id', async (req, res) => {
    const { status, notes } = req.body;
    const order = db.orders.find(o => o.id === parseInt(req.params.id));

    if (!order) {
        return res.status(404).json({
            success: false,
            error: 'Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'
        });
    }

    const validStatuses = ['new', 'preparing', 'ready', 'delivered', 'cancelled'];
    const previousStatus = order.status;

    if (status) {
        if (!validStatuses.includes(status)) {
            return res.status(400).json({
                success: false,
                error: 'Ø­Ø§Ù„Ø© ØºÙŠØ± ØµØ§Ù„Ø­Ø©'
            });
        }
        order.status = status;
        console.log(`ğŸ“ ØªØ­Ø¯ÙŠØ« #${order.id}: ${status}`);

        // âœ… Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ù„Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ù†Ø¯ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù…Ø±Ø­Ù„Ø© "Ø¬Ø§Ù‡Ø²"
        if (status === 'ready' && previousStatus !== 'ready') {
            const orderTypeMsg = {
                'dine_in': 'ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªÙ„Ø§Ù…Ù‡ Ù…Ù† Ø§Ù„ÙƒØ§ÙˆÙ†ØªØ±',
                'car_pickup': 'Ø³Ù†ÙˆØµÙ„Ù‡ Ù„Ø³ÙŠØ§Ø±ØªÙƒ Ø§Ù„Ø¢Ù†',
                'delivery': 'Ø¬Ø§Ø±ÙŠ ØªÙˆØµÙŠÙ„Ù‡ Ø¥Ù„ÙŠÙƒ'
            };

            order.readyNotification = {
                sent: true,
                message: `ğŸ‰ ØªÙ… ØªØ¬Ù‡ÙŠØ² Ø·Ù„Ø¨Ùƒ #${order.id}! ${orderTypeMsg[order.orderType] || ''}`,
                timestamp: new Date().toISOString()
            };
            console.log(`ğŸ”” Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…ÙŠÙ„: ${order.customerName} - Ø·Ù„Ø¨ #${order.id}`);
        }
    }

    if (notes !== undefined) {
        order.notes = notes;
    }

    order.updatedAt = new Date().toISOString();

    res.json({ success: true, order });
});

/**
 * DELETE /api/orders/:id
 * Ø­Ø°Ù Ø·Ù„Ø¨
 */
app.delete('/api/orders/:id', (req, res) => {
    const index = db.orders.findIndex(o => o.id === parseInt(req.params.id));

    if (index === -1) {
        return res.status(404).json({
            success: false,
            error: 'Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯'
        });
    }

    const deleted = db.orders.splice(index, 1)[0];
    console.log(`ğŸ—‘ï¸ Ø­Ø°Ù #${deleted.id}`);

    res.json({ success: true, message: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ù„Ø¨' });
});

/**
 * GET /api/stats
 * Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø·Ù„Ø¨Ø§Øª
 */
app.get('/api/stats', (req, res) => {
    autoCleanup();

    const today = new Date();
    today.setHours(0, 0, 0, 0);
    const todayOrders = db.orders.filter(o => new Date(o.createdAt) >= today);

    // âœ… Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª ØªÙØ­ØªØ³Ø¨ ÙÙ‚Ø· Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³Ù„Ù…Ø© (delivered)
    const deliveredTodayOrders = todayOrders.filter(o => o.status === 'delivered');

    res.json({
        success: true,
        stats: {
            total: db.orders.length,
            today: todayOrders.length,
            todayRevenue: deliveredTodayOrders.reduce((sum, o) => sum + o.total, 0),
            byStatus: {
                new: db.orders.filter(o => o.status === 'new').length,
                preparing: db.orders.filter(o => o.status === 'preparing').length,
                ready: db.orders.filter(o => o.status === 'ready').length,
                delivered: db.orders.filter(o => o.status === 'delivered').length,
                cancelled: db.orders.filter(o => o.status === 'cancelled').length
            },
            // âœ… Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨
            byType: {
                dine_in: db.orders.filter(o => o.orderType === 'dine_in').length,
                car_pickup: db.orders.filter(o => o.orderType === 'car_pickup').length,
                delivery: db.orders.filter(o => o.orderType === 'delivery').length
            }
        }
    });
});

/**
 * GET /api/orders/poll
 * Long polling Ù„Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ©
 */
let lastKnownId = 1000;
app.get('/api/orders/poll', (req, res) => {
    const since = parseInt(req.query.since) || lastKnownId;
    const newOrders = db.orders.filter(o => o.id > since);

    if (newOrders.length > 0) {
        lastKnownId = Math.max(...newOrders.map(o => o.id));
        res.json({
            hasUpdates: true,
            orders: newOrders,
            lastId: lastKnownId
        });
    } else {
        setTimeout(() => {
            res.json({ hasUpdates: false, lastId: since });
        }, 1000);
    }
});

/**
 * GET /api/health
 * ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ø³ÙŠØ±ÙØ±
 */
app.get('/api/health', (req, res) => {
    res.json({
        status: 'ok',
        server: 'Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ† - Backend',
        version: '3.0.0',
        orders: db.orders.length,
        uptime: Math.floor(process.uptime()) + ' Ø«Ø§Ù†ÙŠØ©'
    });
});

/**
 * DELETE /api/cleanup
 * Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª (Ù„Ù„ØªØ·ÙˆÙŠØ± ÙÙ‚Ø·)
 */
app.delete('/api/cleanup', (req, res) => {
    const count = db.orders.length;
    db.orders = [];
    db.counter = 1000;
    console.log(`ğŸ§¹ ØªÙ… Ù…Ø³Ø­ ${count} Ø·Ù„Ø¨`);
    res.json({ success: true, message: `ØªÙ… Ù…Ø³Ø­ ${count} Ø·Ù„Ø¨` });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸš€ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙŠØ±ÙØ±
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

app.listen(PORT, () => {
    console.log(`
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                           â•‘
â•‘   ğŸ”¥  Ù…Ù„Ùƒ Ø§Ù„Ø·Ø§Ø¨ÙˆÙ† - Backend Ø§Ù„Ù…Ø±ÙƒØ²ÙŠ v3.0                                 â•‘
â•‘                                                                           â•‘
â•‘   ğŸ“¡ Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰: http://localhost:${PORT}                             â•‘
â•‘                                                                           â•‘
â•‘   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â•‘
â•‘                                                                           â•‘
â•‘   ğŸ”Œ APIs Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ÙˆÙ„ (Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡):                                         â•‘
â•‘      POST /api/chat         â†’ Ù…Ø­Ø§Ø¯Ø«Ø© Ù…Ø¹ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ                  â•‘
â•‘                                                                           â•‘
â•‘   ğŸ“¦ APIs Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø«Ø§Ù†ÙŠ (Ø§Ù„Ø¹Ù…Ø§Ù„):                                         â•‘
â•‘      GET  /api/orders       â†’ Ø¬Ù„Ø¨ ÙƒÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª                              â•‘
â•‘      GET  /api/orders?orderType=delivery â†’ ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹                 â•‘
â•‘      POST /api/orders       â†’ Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ ÙŠØ¯ÙˆÙŠ                              â•‘
â•‘      PATCH /api/orders/:id  â†’ ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø·Ù„Ø¨                              â•‘
â•‘      DELETE /api/orders/:id â†’ Ø­Ø°Ù Ø·Ù„Ø¨                                     â•‘
â•‘      GET  /api/stats        â†’ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª                                  â•‘
â•‘      GET  /api/orders/poll  â†’ ØªØ­Ø¯ÙŠØ«Ø§Øª ÙÙˆØ±ÙŠØ©                               â•‘
â•‘                                                                           â•‘
â•‘   âœ… Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©:                                              â•‘
â•‘      ğŸ  dine_in     â†’ Ø¯Ø§Ø®Ù„ Ø§Ù„Ù…Ø­Ù„                                          â•‘
â•‘      ğŸš— car_pickup  â†’ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©                                            â•‘
â•‘      ğŸ›µ delivery    â†’ ØªÙˆØµÙŠÙ„ Ù„Ù„Ù…Ù†Ø²Ù„                                        â•‘
â•‘                                                                           â•‘
â•‘   â¤ï¸  GET /api/health        â†’ ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ø³ÙŠØ±ÙØ±                             â•‘
â•‘                                                                           â•‘
â•‘   Ø¬Ø§Ù‡Ø² Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ÙŠÙ†! ğŸš€                                                 â•‘
â•‘                                                                           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    `);
});

module.exports = app;
